sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/m/StandardListItem"],function(e,t,s){"use strict";return e.extend("sap.fiori.gateentrypo.controller.Create",{onInit:function(){this.getView().setModel(new t({}),"HeaderModel");this.getView().setModel(new t([]),"MaterialModel")},onF4Help:function(e){this.f4Source=e.getSource();this.oTemplate=new s({title:"{Po_Number}"});this.openF4Help("Select PO Number","/PoList")},openF4Help:function(e,t){const s=sap.ui.xmlfragment("sap.fiori.gateentrypo.fragment.F4Help",this);this.getView().addDependent(s);sap.ui.getCore().byId("F4Help").setTitle(e);sap.ui.getCore().byId("F4Help").bindAggregation("items",{path:t,template:this.oTemplate});s.open()},onF4HelpSearch:function(e){let t=e.getSource().getBinding("items").getPath();t=t.includes("?search")?t.split("?search")[0]:t.split("&search")[0];sap.ui.getCore().byId("F4Help").bindAggregation("items",{path:t,parameters:{custom:{search:e.getParameter("value")}},template:this.oTemplate})},onF4HelpConfirm:function(e){const t=e.getParameter("selectedItem").getTitle();this.f4Source.setValue(t);this.getView().getModel("HeaderModel").getData().Matnr_Matnr=t;e.getSource().destroy();this.getView().getModel().read("/PoList('"+t+"')/Material_Master",{success:e=>{this.getView().getModel("MaterialModel").setData(e.results.map((e,t)=>{delete e.Po_Number;delete e.GateEntry;e.Count=t+1;return e}));this.getView().getModel("MaterialModel").refresh(true)}})},onSavePress:function(){const e=this.getView().getModel("HeaderModel").getData();this.getView().getModel().create("/GateEntryList",e,{success:()=>sap.m.MessageBox.show("Created successfully",{onClose:()=>this.onNavBack()})})}})});